# Place all the behaviors and hooks related to the matching controller here.
# All this logic will automatically be available in application.js.
# You can use CoffeeScript in this file: http://jashkenas.github.com/coffee-script/

$ ->

  $('tr.kind').click (e) ->
    tr = $(e.currentTarget)
    tr.toggleClass('open')
    if tr.hasClass('open')
      $(".company.#{tr[0].id}").fadeIn()
    else
      $(".#{tr[0].id}").fadeOut()
      $(".#{tr[0].id}").removeClass('open')
    e.preventDefault()

  $('tr.company').click (e) ->
    tr = $(e.currentTarget)
    tr.toggleClass('open')
    $(".model.#{tr[0].id}").fadeToggle()
    e.preventDefault()

  $('select').change (e) ->
    select = $(e.currentTarget)
    tr = select.parents('tr')
    id = tr[0].id + '_clone'
    id_selector = '#' + id
    if parseInt(select.val()) > 0
      clone = tr.clone().attr('id', id)
      $('select', clone).val(select.val())#.attr('disabled', 'true');
      if $(id_selector).length == 0
        $('#added_models').append clone
      else
        $(id_selector).replaceWith clone
    else
      $(id_selector).remove()

  $('h4 small a').click (e) ->
    $('#available_models').toggle()
    if $('h4 small a').text() == 'hide'
      $('h4 small a').text('show')
    else
      $('h4 small a').text('hide')


